@echo off
cls
echo ================================
echo üîß OBBPD Build Troubleshooter
echo ================================

REM === Step 1: Confirm Python is Installed
echo.
echo [1] Checking Python installation...
where python >nul 2>&1
IF ERRORLEVEL 1 (
    echo ‚ùå Python not found. Please install Python and make sure it's added to PATH.
    goto end
) ELSE (
    echo ‚úÖ Python found.
)

REM === Step 2: Confirm PyInstaller is Installed
echo.
echo [2] Checking PyInstaller installation...
pyinstaller --version >nul 2>&1
IF ERRORLEVEL 1 (
    echo ‚ùå PyInstaller not found.
    echo üëâ Run: pip install pyinstaller
    goto end
) ELSE (
    echo ‚úÖ PyInstaller is installed.
)

REM === Step 3: Check for required files
echo.
echo [3] Checking required files...

IF NOT EXIST OBBPD.py (
    echo ‚ùå Missing: OBBPD.py
    goto end
)
IF NOT EXIST obbpd_config.ini (
    echo ‚ùå Missing: obbpd_config.ini
    goto end
)
IF NOT EXIST version.txt (
    echo ‚ùå Missing: version.txt
    goto end
)
IF NOT EXIST OBBPD_oblivion_themed_transparent.ico (
    echo ‚ùå Missing: OBBPD_oblivion_themed_transparent.ico
    goto end
)
echo ‚úÖ All required files found.

REM === Step 4: Start Build Process
echo.
echo [4] Running PyInstaller...

pyinstaller --onefile --name "OBBPD" ^
--icon "OBBPD_oblivion_themed_transparent.ico" ^
--version-file "version.txt" ^
--add-data "obbpd_config.ini;." ^
OBBPD.py

IF EXIST dist\OBBPD.exe (
    echo.
    echo ‚úÖ Build successful! EXE created at: dist\OBBPD.exe
) ELSE (
    echo.
    echo ‚ùå Build failed. Please review the error messages above.
)

:end
echo.
echo ===================================
echo üß™ Build process complete.
echo (This window will stay open.)
echo ===================================
pause